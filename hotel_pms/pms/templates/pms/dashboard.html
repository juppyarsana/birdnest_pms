{% load humanize %}
<!DOCTYPE html>
<html>
<head>
    <title>Hotel PMS</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body>
    <div class="container mt-4">
        <h1>Hotel Dashboard (5 Rooms)</h1>
        <p>Daily Occupancy (Today): {{ daily_occupancy|floatformat:1 }}% (Target: {{ target_occupancy }}%)</p>
        <p>Monthly Occupancy ({{ month_name }}): {{ monthly_occupancy|floatformat:1 }}% (Target: {{ target_occupancy }}%)</p>
        <a href="{% url 'create_reservation' %}" class="btn btn-primary mb-3">New Reservation</a>
        <a href="{% url 'calendar' %}" class="btn btn-secondary mb-3">View Calendar</a>
        <h3>Rooms</h3>
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Room</th>
                    <th>Type</th>
                    <th>Rate</th>
                    <th>Status</th>
                </tr>
            </thead>
            <tbody>
                {% for room in rooms %}
                <tr>
                    <td>{{ room.room_number }}</td>
                    <td>{{ room.room_type }}</td>
                    <td>Rp {{ room.rate|intcomma }}</td>
                    <td>{{ room.status }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        <h3>Pending Reservations</h3>
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Guest</th>
                    <th>Room</th>
                    <th>Check-In</th>
                    <th>Check-Out</th>
                    <th>Status</th>
                    <th>Payment Method</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody>
                {% for reservation in pending_reservations %}
                <tr>
                    <td>{{ reservation.guest.name }}</td>
                    <td>{{ reservation.room.room_number }}</td>
                    <td>{{ reservation.check_in }}</td>
                    <td>{{ reservation.check_out }}</td>
                    <td>{{ reservation.status }}</td>
                    <td>{{ reservation.get_payment_method_display|default:"Not Specified" }}</td>
                    <td><a href="{% url 'confirm_reservation' reservation.id %}" class="btn btn-sm btn-success">Confirm</a></td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="7">No pending reservations</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        <h3>Expected Arrivals</h3>
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Guest</th>
                    <th>Room</th>
                    <th>Check-In</th>
                    <th>Check-Out</th>
                    <th>Status</th>
                    <th>Payment Method</th>
                </tr>
            </thead>
            <tbody>
                {% for reservation in expected_arrivals %}
                <tr>
                    <td>{{ reservation.guest.name }}</td>
                    <td>{{ reservation.room.room_number }}</td>
                    <td>{{ reservation.check_in }}</td>
                    <td>{{ reservation.check_out }}</td>
                    <td>{{ reservation.status }}</td>
                    <td>{{ reservation.get_payment_method_display|default:"Not Specified" }}</td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="6">No expected arrivals</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        <h3>Expected Departures</h3>
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Guest</th>
                    <th>Room</th>
                    <th>Check-In</th>
                    <th>Check-Out</th>
                    <th>Status</th>
                    <th>Payment Method</th>
                </tr>
            </thead>
            <tbody>
                {% for reservation in expected_departures %}
                <tr>
                    <td>{{ reservation.guest.name }}</td>
                    <td>{{ reservation.room.room_number }}</td>
                    <td>{{ reservation.check_in }}</td>
                    <td>{{ reservation.check_out }}</td>
                    <td>{{ reservation.status }}</td>
                    <td>{{ reservation.get_payment_method_display|default:"Not Specified" }}</td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="6">No expected departures</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        <h3>Confirmed Reservations (Today)</h3>
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Guest</th>
                    <th>Room</th>
                    <th>Check-In</th>
                    <th>Check-Out</th>
                    <th>Status</th>
                    <th>Payment Method</th>
                </tr>
            </thead>
            <tbody>
                {% for reservation in reservations %}
                <tr>
                    <td>{{ reservation.guest.name }}</td>
                    <td>{{ reservation.room.room_number }}</td>
                    <td>{{ reservation.check_in }}</td>
                    <td>{{ reservation.check_out }}</td>
                    <td>{{ reservation.status }}</td>
                    <td>{{ reservation.get_payment_method_display|default:"Not Specified" }}</td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="6">No confirmed reservations for today</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        <h3>Canceled Reservations</h3>
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Guest</th>
                    <th>Room</th>
                    <th>Check-In</th>
                    <th>Check-Out</th>
                    <th>Status</th>
                    <th>Payment Method</th>
                </tr>
            </thead>
            <tbody>
                {% for reservation in canceled_reservations %}
                <tr>
                    <td>{{ reservation.guest.name }}</td>
                    <td>{{ reservation.room.room_number }}</td>
                    <td>{{ reservation.check_in }}</td>
                    <td>{{ reservation.check_out }}</td>
                    <td>{{ reservation.status }}</td>
                    <td>{{ reservation.get_payment_method_display|default:"Not Specified" }}</td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="6">No canceled reservations</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        <h3>No-Show Reservations</h3>
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Guest</th>
                    <th>Room</th>
                    <th>Check-In</th>
                    <th>Check-Out</th>
                    <th>Status</th>
                    <th>Payment Method</th>
                </tr>
            </thead>
            <tbody>
                {% for reservation in no_show_reservations %}
                <tr>
                    <td>{{ reservation.guest.name }}</td>
                    <td>{{ reservation.room.room_number }}</td>
                    <td>{{ reservation.check_in }}</td>
                    <td>{{ reservation.check_out }}</td>
                    <td>{{ reservation.status }}</td>
                    <td>{{ reservation.get_payment_method_display|default:"Not Specified" }}</td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="6">No no-show reservations</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        <h3>All Reservations (Debug)</h3>
        <table class="table table-striped">
            <thead>
                <tr>
                    <th>Guest</th>
                    <th>Room</th>
                    <th>Check-In</th>
                    <th>Check-Out</th>
                    <th>Status</th>
                    <th>Payment Method</th>
                </tr>
            </thead>
            <tbody>
                {% for reservation in all_reservations %}
                <tr>
                    <td>{{ reservation.guest.name }}</td>
                    <td>{{ reservation.room.room_number }}</td>
                    <td>{{ reservation.check_in }}</td>
                    <td>{{ reservation.check_out }}</td>
                    <td>{{ reservation.status }}</td>
                    <td>{{ reservation.get_payment_method_display|default:"Not Specified" }}</td>
                </tr>
                {% empty %}
                <tr>
                    <td colspan="6">No reservations in database</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</body>
</html>